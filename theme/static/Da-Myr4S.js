import{m as i,f as r,a as n,T as o}from"./vendor.s2Y4qQG_.js";document.addEventListener("alpine:init",()=>{i.data("removeEmptyHeader",()=>({init(){this.$el.innerText.length==0&&this.$el.remove()}})),i.data("showToggler",()=>({open:!1,toggle(){this.open=!this.open}})),i.data("autofocusing",()=>({init(){this.$el.querySelector('input:not([type="hidden"])').focus()}})),i.data("nav",()=>({open:!1,init(){const t=document.querySelector(".links-list");t.style.maxHeight="0px"},toggle(){navLinksList.style.maxHeight==="0px"?navLinksList.style.maxHeight=navLinksList.scrollHeight+"px":navLinksList.style.maxHeight="0px",this.open=!this.open}})),i.data("profileForm",()=>({init(){r("#id_date_of_birth",{}),this.$refs.photoInput.addEventListener("change",t=>{const e=t.target.files[0];if(e){const s=new FileReader;s.onload=a=>{this.$refs.photoImg.src=a.target.result},s.readAsDataURL(e)}})},openPhotoImgInput(){this.$refs.photoInput.click()}})),i.data("newPostForm",()=>({editor:null,csrftoken:null,init(){this.csrftoken=n.get("csrftoken"),this.editor=new o({el:this.$el.querySelector("#markdown-editor"),height:"31.25rem",initialEditType:"markdown",previewStyle:"tab",theme:"dark",hideModeSwitch:!0})},async post(t){const e=new FormData;e.append("action",t),e.append("title",this.$refs.title.value),e.append("body",this.editor.getMarkdown());const a=await(await fetch("/posts/new",{method:"POST",headers:{"X-CSRFToken":this.csrftoken},mode:"same-origin",body:e})).json();window.location.assign(a.url)}})),i.data("updatePostForm",()=>({editor:null,id:null,csrftoken:null,init(){this.csrftoken=n.get("csrftoken"),this.id=this.$el.dataset.id;const t=this.$el.querySelector("#markdown-editor");this.editor=new o({el:t,height:"31.25rem",initialEditType:"markdown",previewStyle:"tab",theme:"dark",hideModeSwitch:!0,initialValue:t.textContent.trim()})},async update(){const t=new FormData;t.append("title",this.$refs.title.value),t.append("body",this.editor.getMarkdown());const s=await(await fetch(`/posts/${this.id}/edit/`,{method:"POST",headers:{"X-CSRFToken":this.csrftoken},mode:"same-origin",body:t})).json();window.location.assign(s.url)},cancel(){history.back()}})),i.data("postsList",()=>({page:1,isFetching:!1,emptyPage:!1,init(){window.addEventListener("scroll",()=>{const t=document.body.clientHeight-window.innerHeight-200;window.scrollY>t&&!this.emptyPage&&!this.isFetching&&this.fetchPosts()})},async fetchPosts(){this.page++,this.isFetching=!0;const e=await(await fetch(`?list_paginated=1&page=${this.page}`)).text();e==""&&(this.emptyPage=!0),this.$el.querySelector("ul.main-list").insertAdjacentHTML("beforeend",e),this.isFetching=!1}}))});i.start();
